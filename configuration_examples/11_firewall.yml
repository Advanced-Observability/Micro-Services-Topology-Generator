frontend:
  type: service
  port: 80
  endpoints:
    - entrypoint: /
      psize: 256
      connections:
        - path: r1->fw1->db
          url: /
r1:
  type: router
  connections:
    - path: fw1
fw1:
  type: firewall
  default: drop
  connections:
    - path: db
  rules:
    - source: frontend
      sport: "*"
      destination: db
      dport: 10001
      protocol: tcp
      action: accept
    - source: db
      sport: 10001
      destination: frontend
      dport: "*"
      protocol: tcp
      action: accept

db:
  type: service
  port: 10001
  endpoints:
    - entrypoint: /
      psize: 128